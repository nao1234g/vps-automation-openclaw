# ============================================================================
# OpenClaw VPS - Production Environment Configuration
# ============================================================================
#
# 本番環境用の環境変数設定例
# このファイルをコピーして使用: cp .env.production.example .env
#
# セキュリティ:
# - パスワードは openssl rand -base64 32 で生成
# - APIキーは各サービスのコンソールから取得
# - .env ファイルのパーミッション: chmod 600 .env
#
# ============================================================================

# ----------------------------------------------------------------------------
# Database Configuration
# ----------------------------------------------------------------------------

POSTGRES_USER=openclaw
POSTGRES_PASSWORD=CHANGE_THIS_TO_STRONG_PASSWORD
POSTGRES_DB=openclaw

# PostgreSQL Performance Tuning
# メモリの25%を推奨
POSTGRES_SHARED_BUFFERS=1GB
# メモリの50-75%を推奨
POSTGRES_EFFECTIVE_CACHE_SIZE=3GB
# 複雑なクエリ用（4MB-16MB）
POSTGRES_WORK_MEM=8MB
# メンテナンス用（256MB-2GB）
POSTGRES_MAINTENANCE_WORK_MEM=512MB

# ----------------------------------------------------------------------------
# LLM Provider Configuration
# ----------------------------------------------------------------------------

# Anthropic Claude API
# https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

# Default Model Selection
ANTHROPIC_MODEL=claude-sonnet-4-5-20250929
ANTHROPIC_MAX_TOKENS=4096
ANTHROPIC_TEMPERATURE=0.7

# API Rate Limiting
ANTHROPIC_REQUESTS_PER_MINUTE=50
ANTHROPIC_TOKENS_PER_DAY=1000000

# ----------------------------------------------------------------------------
# OpenClaw Configuration
# ----------------------------------------------------------------------------

# Application Settings
NODE_ENV=production
PORT=3000
LOG_LEVEL=info

# Session & Security
SESSION_SECRET=CHANGE_THIS_TO_RANDOM_STRING_MIN_32_CHARS
JWT_SECRET=CHANGE_THIS_TO_RANDOM_STRING_MIN_32_CHARS
JWT_EXPIRES_IN=24h

# CORS Settings
CORS_ORIGIN=https://your-domain.com
ALLOWED_ORIGINS=https://your-domain.com,https://www.your-domain.com

# ----------------------------------------------------------------------------
# Telegram Bot Configuration
# ----------------------------------------------------------------------------

# Telegram Bot Token
# Get from: @BotFather on Telegram
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrSTUvwxYZ1234567890

# Telegram Chat ID（自分のChat ID）
# Get from: @userinfobot
TELEGRAM_CHAT_ID=123456789

# Telegram Settings
TELEGRAM_PARSE_MODE=Markdown
TELEGRAM_DISABLE_NOTIFICATION=false

# ----------------------------------------------------------------------------
# N8N Configuration
# ----------------------------------------------------------------------------

# N8N Basic Settings
N8N_HOST=n8n.your-domain.com
N8N_PORT=5678
N8N_PROTOCOL=https
N8N_EDITOR_BASE_URL=https://n8n.your-domain.com

# N8N Security
N8N_BASIC_AUTH_ACTIVE=true
N8N_BASIC_AUTH_USER=admin
N8N_BASIC_AUTH_PASSWORD=CHANGE_THIS_TO_STRONG_PASSWORD

# N8N Encryption Key（初回起動時に自動生成されるが、明示的に指定推奨）
N8N_ENCRYPTION_KEY=CHANGE_THIS_TO_RANDOM_STRING_MIN_32_CHARS

# N8N Execution Settings
EXECUTIONS_PROCESS=main
EXECUTIONS_MODE=regular
EXECUTIONS_TIMEOUT=300
EXECUTIONS_TIMEOUT_MAX=3600

# N8N Data Retention
EXECUTIONS_DATA_SAVE_ON_ERROR=all
EXECUTIONS_DATA_SAVE_ON_SUCCESS=all
EXECUTIONS_DATA_SAVE_MANUAL_EXECUTIONS=true
EXECUTIONS_DATA_PRUNE=true
EXECUTIONS_DATA_MAX_AGE=336  # 14 days

# N8N Timezone
GENERIC_TIMEZONE=Asia/Tokyo
TZ=Asia/Tokyo

# ----------------------------------------------------------------------------
# OpenNotebook Configuration
# ----------------------------------------------------------------------------

OPENNOTEBOOK_PORT=8080
OPENNOTEBOOK_HOST=0.0.0.0

# OpenNotebook Database
OPENNOTEBOOK_DB_HOST=postgres
OPENNOTEBOOK_DB_PORT=5432
OPENNOTEBOOK_DB_NAME=opennotebook
OPENNOTEBOOK_DB_USER=openclaw
OPENNOTEBOOK_DB_PASSWORD=${POSTGRES_PASSWORD}

# OpenNotebook Storage
OPENNOTEBOOK_UPLOAD_DIR=/app/uploads
OPENNOTEBOOK_MAX_FILE_SIZE=50MB

# ----------------------------------------------------------------------------
# Nginx Configuration
# ----------------------------------------------------------------------------

# Domain Settings
DOMAIN_NAME=your-domain.com
WWW_DOMAIN=www.your-domain.com

# SSL/TLS Settings
SSL_CERTIFICATE_PATH=/etc/letsencrypt/live/${DOMAIN_NAME}/fullchain.pem
SSL_CERTIFICATE_KEY_PATH=/etc/letsencrypt/live/${DOMAIN_NAME}/privkey.pem

# Let's Encrypt Email
LETSENCRYPT_EMAIL=admin@your-domain.com

# Nginx Tuning
NGINX_WORKER_PROCESSES=auto
NGINX_WORKER_CONNECTIONS=1024
NGINX_CLIENT_MAX_BODY_SIZE=50M

# ----------------------------------------------------------------------------
# Monitoring Configuration
# ----------------------------------------------------------------------------

# Grafana Settings
GF_SECURITY_ADMIN_USER=admin
GF_SECURITY_ADMIN_PASSWORD=CHANGE_THIS_TO_STRONG_PASSWORD
GF_SECURITY_SECRET_KEY=CHANGE_THIS_TO_RANDOM_STRING_MIN_32_CHARS

GF_SERVER_PROTOCOL=https
GF_SERVER_DOMAIN=grafana.your-domain.com
GF_SERVER_ROOT_URL=https://grafana.your-domain.com

GF_AUTH_ANONYMOUS_ENABLED=false
GF_AUTH_DISABLE_LOGIN_FORM=false

# Prometheus Settings
PROMETHEUS_RETENTION_TIME=30d
PROMETHEUS_STORAGE_TSDB_PATH=/prometheus

# Alertmanager Settings
ALERTMANAGER_SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
ALERTMANAGER_EMAIL_TO=alerts@your-domain.com
ALERTMANAGER_EMAIL_FROM=alertmanager@your-domain.com

# ----------------------------------------------------------------------------
# Backup Configuration
# ----------------------------------------------------------------------------

# Backup Directory
BACKUP_DIR=/opt/backups/openclaw
BACKUP_RETENTION_DAYS=30

# Offsite Backup Settings（オプション）
# AWS S3
AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
AWS_S3_BACKUP_BUCKET=your-backup-bucket
AWS_REGION=ap-northeast-1

# Or Google Cloud Storage
# GCS_BACKUP_BUCKET=your-backup-bucket
# GOOGLE_APPLICATION_CREDENTIALS=/path/to/credentials.json

# ----------------------------------------------------------------------------
# Security Configuration
# ----------------------------------------------------------------------------

# Fail2ban Settings
FAIL2BAN_MAXRETRY=5
FAIL2BAN_BANTIME=3600
FAIL2BAN_FINDTIME=600

# UFW Firewall
UFW_ALLOWED_PORTS=22,80,443
UFW_RATE_LIMIT_SSH=yes

# Security Scan Settings
TRIVY_SEVERITY=CRITICAL,HIGH,MEDIUM
SECURITY_SCAN_SCHEDULE=0 2 * * *  # Daily at 2 AM

# ----------------------------------------------------------------------------
# Feature Flags
# ----------------------------------------------------------------------------

# Enable/Disable Features
FEATURE_TELEGRAM_NOTIFICATIONS=true
FEATURE_EMAIL_NOTIFICATIONS=false
FEATURE_SLACK_NOTIFICATIONS=false
FEATURE_AUTO_BACKUP=true
FEATURE_METRICS_COLLECTION=true

# ----------------------------------------------------------------------------
# Rate Limiting & Throttling
# ----------------------------------------------------------------------------

# API Rate Limits
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100

# Request Throttling
THROTTLE_TTL=60
THROTTLE_LIMIT=10

# ----------------------------------------------------------------------------
# Logging Configuration
# ----------------------------------------------------------------------------

# Log Settings
LOG_FORMAT=json
LOG_TIMESTAMP_FORMAT=YYYY-MM-DD HH:mm:ss

# Log Rotation
LOG_MAX_SIZE=100M
LOG_MAX_FILES=10
LOG_COMPRESS=true

# ----------------------------------------------------------------------------
# Cache Configuration
# ----------------------------------------------------------------------------

# Redis Settings（オプション - 将来的な実装用）
# REDIS_HOST=redis
# REDIS_PORT=6379
# REDIS_PASSWORD=CHANGE_THIS_TO_STRONG_PASSWORD
# REDIS_DB=0
# CACHE_TTL=3600

# ----------------------------------------------------------------------------
# Email Configuration（オプション）
# ----------------------------------------------------------------------------

# SMTP Settings for Email Notifications
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_SECURE=false
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-app-password
# SMTP_FROM=noreply@your-domain.com

# ----------------------------------------------------------------------------
# Development Tools（本番では無効化推奨）
# ----------------------------------------------------------------------------

# Debug Settings（本番では false に設定）
DEBUG=false
VERBOSE=false

# Development Tools Access（本番では無効化）
ADMINER_ENABLED=false
PGADMIN_ENABLED=false
MAILHOG_ENABLED=false

# ----------------------------------------------------------------------------
# Custom Application Settings
# ----------------------------------------------------------------------------

# アプリケーション固有の設定をここに追加
# CUSTOM_SETTING_1=value1
# CUSTOM_SETTING_2=value2

# ============================================================================
# セキュリティチェックリスト
# ============================================================================
#
# 本番環境デプロイ前に確認:
# [ ] 全てのパスワードが変更されている
# [ ] APIキーが正しく設定されている
# [ ] ドメイン名が正しい
# [ ] SSL証明書のメールアドレスが正しい
# [ ] DEBUG=false に設定されている
# [ ] ファイルパーミッション chmod 600 .env
# [ ] .gitignore に .env が含まれている
#
# ============================================================================
